const cdsc = require ('@sap/cds-compiler')
const {env} = require ('../index')

function _options (_o,_4odata) {
  if (typeof _o === 'string') _o = {version:_o}
  const o = _4odata ? { ...env.effective.cdsc(_o), ..._o, ...env.cdsc } : { ..._o, ...env.cdsc }
  const names = o.names || o.sql_mapping || env.sql.names
  if (names !== 'plain') o.sqlMapping = names
  if (!o.messages) o.messages = [] //> this is to avoid cdsc printing directly to stdout
  return o
}

module.exports = Object.assign (cdsc, {_options})
